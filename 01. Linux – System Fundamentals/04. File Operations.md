# **04. File Operations — Creating, Managing, and Processing Files**
> Mastering file manipulation from creation to deletion — the essential DevOps toolkit.

---

## Table of Contents
- [1. Why File Operations Matter](#1-why-file-operations-matter)
- [2. The Confusion Around File Management](#2-the-confusion-around-file-management)
- [3. File Lifecycle: Inside-Out](#3-file-lifecycle-inside-out)
- [4. Core Concepts](#4-core-concepts)
- [5. Real-World Scenarios](#5-real-world-scenarios)
- [6. Commands Toolbox](#6-commands-toolbox)
- [7. Quick Summary](#7-quick-summary)

---

<details>
<summary><strong>1. Why File Operations Matter</strong></summary>

<div style="margin-left: 16px; margin-right: 16px; margin-top: 8px; margin-bottom: 8px;">

Every DevOps task involves file manipulation.

Deploying code? You're copying files.
Managing configs? You're editing and moving files.
Debugging issues? You're reading log files.
Backing up data? You're archiving files.

Understanding file operations means:
- you can automate deployments confidently
- you can process logs efficiently
- you can manage configs safely
- you can troubleshoot file issues quickly

This isn't about memorizing commands.
It's about understanding how files are created, moved, viewed, and deleted — and how to chain operations together.

</div>

</details>

---

<details>
<summary><strong>2. The Confusion Around File Management</strong></summary>

<div style="margin-left: 16px; margin-right: 16px; margin-top: 8px; margin-bottom: 8px;">

Most beginners struggle because they don't understand the difference between copying, moving, and linking.

**Common Problems:**
- "I deleted a file but it's still referenced somewhere"
- "I copied a directory but it didn't work"
- "How do I process multiple files at once?"
- "What's the difference between `cat` and `less`?"
- "How do I save command output permanently?"

**The Root Cause:**
Not understanding:
- file metadata vs file content
- hard links vs symbolic links
- when to use copy vs move
- how redirection captures output
- how globbing patterns work

**What This File Fixes:**
You'll master creating, copying, moving, deleting, viewing, and processing files. You'll understand redirection completely, use globbing patterns confidently, and know when to use hard vs soft links.

</div>

</details>

---

<details>
<summary><strong>3. File Lifecycle: Inside-Out</strong></summary>

<div style="margin-left: 16px; margin-right: 16px; margin-top: 8px; margin-bottom: 8px;">

Files go through a predictable lifecycle:

```
┌──────────────────────────────────────────┐
│   Create (touch, mkdir, echo >)          │
└────────────┬─────────────────────────────┘
             │
┌────────────▼─────────────────────────────┐
│   Edit (nano, vi, echo >>)               │
└────────────┬─────────────────────────────┘
             │
┌────────────▼─────────────────────────────┐
│   View (cat, less, head, tail)           │
└────────────┬─────────────────────────────┘
             │
┌────────────▼─────────────────────────────┐
│   Copy/Move (cp, mv)                     │
└────────────┬─────────────────────────────┘
             │
┌────────────▼─────────────────────────────┐
│   Link (ln, ln -s)                       │
└────────────┬─────────────────────────────┘
             │
┌────────────▼─────────────────────────────┐
│   Delete (rm, rmdir)                     │
└──────────────────────────────────────────┘
```

**Key Insight:**
Each operation changes either:
- **File content** (edit, append)
- **File location** (move, copy)
- **File metadata** (touch, chmod — covered in File 06)
- **File references** (links)

Understanding this flow prevents mistakes like accidentally deleting important files or breaking symbolic links.

**Data Flow with Redirection and Pipes:**

```
Command → stdout → Terminal (default)
        ↓
        > file.txt (redirect, overwrite)
        >> file.txt (redirect, append)
        | next_command (pipe to another command)
```

</div>

</details>

---

<details>
<summary><strong>4. Core Concepts</strong></summary>

<div style="margin-left: 16px; margin-right: 16px; margin-top: 8px; margin-bottom: 8px;">

### FOP-001 — Creating Files

**`touch`:**
Creates an empty file if it doesn't exist, or updates its timestamps if it does.

```bash copy
touch file1.txt
```

**Use Cases:**
- Create empty file as placeholder
- Update modification time
- Test file permissions

**Creating Files with Content:**
```bash copy
echo "Hello World" > file.txt
```

---

### FOP-002 — Identifying File Types

**`file`:**
Examines contents and reports type (text, executable, image, etc.).

```bash copy
file file1.txt
# Output: file1.txt: ASCII text
```

**Why This Matters:**
Some files look like text but aren't. `file` tells you the truth.

```bash copy
file /bin/ls
# Output: /bin/ls: ELF 64-bit LSB executable
```

---

### FOP-003 — Inspecting File Metadata

**`stat`:**
Shows detailed metadata: size, permissions, and timestamps.

```bash copy
stat file1.txt
```

**Output Includes:**
- File size
- Inode number
- Permissions
- Access time (atime)
- Modification time (mtime)
- Change time (ctime)

**Why This Matters:**
Debugging file issues often requires knowing when a file was last modified or accessed.

---

### FOP-004 — Copying Files

**`cp` (Copy):**
Duplicates files or directories.

**Basic:**
```bash copy
cp source.txt destination.txt
```

**Interactive (`-i`):**
Prompts before overwrite.
```bash copy
cp -i file1.txt file2.txt
```

**Verbose (`-v`):**
Prints each copy action.
```bash copy
cp -v file1.txt backup/
# Output: 'file1.txt' -> 'backup/file1.txt'
```

**Recursive (`-r`):**
Copies directories and all contents.
```bash copy
cp -r src/ backup/
```

**Combined (`-rv`):**
Recursive with verbose output.
```bash copy
cp -rv src/ backup/
```

**Best Practice:**
Use `cp -iv` for safety (interactive + verbose).

---

### FOP-005 — Moving and Renaming Files

**`mv` (Move/Rename):**
Moves or renames files while preserving metadata.

**Rename:**
```bash copy
mv oldname.txt newname.txt
```

**Move:**
```bash copy
mv file.txt /home/akhil/documents/
```

**Interactive (`-i`):**
```bash copy
mv -i file1.txt file2.txt
```

**Verbose (`-v`):**
```bash copy
mv -v file.txt backup/
```

**Why Use `mv` Instead of `cp` + `rm`?**
`mv` preserves file metadata (timestamps, permissions) and is faster.

---

### FOP-006 — Deleting Files

**`rm` (Remove):**
Deletes files (no trash bin — permanent deletion).

**Basic:**
```bash copy
rm file.txt
```

**Interactive (`-i`):**
Prompts before each deletion.
```bash copy
rm -i file.txt
```

**Recursive (`-r`):**
Removes directory trees and contents.
```bash copy
rm -r directory/
```

**Force (`-f`):**
Ignores nonexistent files and suppresses prompts.
```bash copy
rm -f file.txt
```

**Dangerous Combination:**
```bash copy
rm -rf directory/
```
**Use with extreme caution!** This force-deletes everything without confirmation.

**Safer Alternative:**
```bash copy
rm -riv directory/
# Interactive + verbose for safety
```

---

### FOP-007 — Viewing File Contents

**`cat` (Concatenate):**
Prints entire file to stdout.

```bash copy
cat file1.txt
```

**Number Lines:**
```bash copy
cat -n file1.txt
```

**`tac`:**
Prints file in reverse order.
```bash copy
tac file1.txt
```

**`nl` (Number Lines):**
Alternative line numbering.
```bash copy
nl file1.txt
```

**When to Use:**
- `cat` — small files, quick view
- `less` — large files, need scrolling
- `head`/`tail` — first/last lines only

---

### FOP-008 — Previewing File Sections

**`head`:**
Shows first 10 lines by default.

```bash copy
head file.txt
```

**First N lines:**
```bash copy
head -n 20 file.txt
```

**`tail`:**
Shows last 10 lines by default.

```bash copy
tail file.txt
```

**Last N lines:**
```bash copy
tail -n 20 file.txt
```

**Follow Mode (`-f`):**
Watches file for new lines (perfect for logs).
```bash copy
tail -f /var/log/nginx/access.log
```

**Press Ctrl+C to exit.**

---

### FOP-009 — Paging Through Files

**`more`:**
Paginates forward only (legacy tool).
```bash copy
more long.txt
```

**`less`:**
Allows forward/backward navigation (preferred).
```bash copy
less journal.txt
```

**Navigation in `less`:**
- `Space` — next page
- `b` — previous page
- `/pattern` — search forward
- `?pattern` — search backward
- `q` — quit

**Why `less` is Better:**
- Backward navigation
- Search capability
- Faster on large files
- Doesn't load entire file into memory

---

### FOP-010 — Globbing (Wildcards)

Globbing lets you match multiple files with patterns.

**`*` (Asterisk):**
Matches zero or more characters.

```bash copy
ls *.txt           # all .txt files
rm temp*           # all files starting with "temp"
cp *.log backup/   # all .log files to backup/
```

**`?` (Question Mark):**
Matches exactly one character.

```bash copy
ls file?.txt       # file1.txt, file2.txt, fileA.txt
rm test?.log       # test1.log, test2.log, but not test10.log
```

**`[]` (Brackets):**
Matches any one character inside brackets.

```bash copy
ls file[123].txt   # file1.txt, file2.txt, file3.txt
rm log[A-Z].txt    # logA.txt, logB.txt, etc.
```

**Combining Patterns:**
```bash copy
ls file[0-9]*.txt  # file1.txt, file123.txt, file9backup.txt
```

**Negation:**
```bash copy
ls file[!0-9].txt  # files NOT ending with a digit before .txt
```

---

### FOP-011 — Redirection (Complete Guide)

Redirection controls where command output goes.

**Standard Streams:**
- **stdin (0)** — standard input
- **stdout (1)** — standard output
- **stderr (2)** — standard error

**`>` (Redirect stdout, Overwrite):**
```bash copy
ls -l > files.txt
# Saves ls output to files.txt (overwrites existing)
```

**`>>` (Redirect stdout, Append):**
```bash copy
echo "New entry" >> log.txt
# Adds to end of log.txt
```

**`<` (Redirect stdin):**
```bash copy
wc -l < file.txt
# Feeds file.txt as input to wc
```

**`2>` (Redirect stderr):**
```bash copy
command 2> errors.txt
# Saves error messages to errors.txt
```

**`2>&1` (Redirect stderr to stdout):**
```bash copy
command > output.txt 2>&1
# Saves both stdout and stderr to output.txt
```

**`&>` (Shortcut for both):**
```bash copy
command &> all_output.txt
# Same as above, shorter syntax
```

**Discarding Output:**
```bash copy
command > /dev/null 2>&1
# Silences all output
```

**Common Pattern:**
```bash copy
./deploy.sh > deploy.log 2>&1
# Captures all output for later review
```

---

### FOP-012 — Pipes (Complete Guide)

**Pipe (`|`):**
Connects stdout of one command to stdin of another.

**Basic Example:**
```bash copy
cat file.txt | grep "error"
# Searches for "error" in file.txt
```

**Chaining Multiple Commands:**
```bash copy
cat access.log | grep "404" | wc -l
# Counts 404 errors in log
```

**Common Patterns:**

**Sorting:**
```bash copy
ls -l | sort -k5 -n
# Sort files by size (column 5)
```

**Filtering:**
```bash copy
ps aux | grep nginx
# Find nginx processes
```

**Counting:**
```bash copy
ls | wc -l
# Count files in directory
```

**Combining with Redirection:**
```bash copy
cat file.txt | grep "error" > errors.txt
# Filter and save
```

**Real DevOps Use:**
```bash copy
docker ps | grep "running" | wc -l
# Count running containers
```

---

### FOP-013 — File Type Indicators

When you run `ls -l`, the first character tells you the file type:

| Indicator | Type           | Description                |
|-----------|----------------|----------------------------|
| `-`       | Regular file   | Text or binary file        |
| `d`       | Directory      | Folder                     |
| `l`       | Symbolic link  | Pointer to another file    |
| `b`       | Block device   | Storage device             |
| `c`       | Character device | Terminal, printer        |
| `p`       | Named pipe     | FIFO for IPC               |
| `s`       | Socket         | Network communication      |

**Example:**
```bash copy
ls -l
# Output:
# drwxr-xr-x  2 akhil akhil 4096 Jan 15 10:00 documents
# -rw-r--r--  1 akhil akhil  123 Jan 15 10:01 file.txt
# lrwxrwxrwx  1 akhil akhil    9 Jan 15 10:02 link -> file.txt
```

---

### FOP-014 — Hard Links vs Symbolic Links

**Hard Link:**
Points to the same inode (actual file data on disk).

```bash copy
ln original.txt hardlink.txt
```

**Properties:**
- Same inode number
- Deleting original doesn't break link
- Can't link across filesystems
- Can't link directories

**Checking:**
```bash copy
ls -li
# Shows inode numbers — hard links share the same inode
```

**Symbolic (Soft) Link:**
Points to the filename, not the inode.

```bash copy
ln -s original.txt symlink.txt
```

**Properties:**
- Different inode number
- Deleting original breaks link
- Can link across filesystems
- Can link directories

**Visual:**
```bash copy
ls -l symlink.txt
# Output: lrwxrwxrwx ... symlink.txt -> original.txt
```

**When to Use:**
- **Hard link:** Backup important files (data preserved even if original deleted)
- **Soft link:** Shortcuts, cross-filesystem links, directory links

**Example:**
```bash copy
# Create soft link to logs directory
ln -s /var/log/nginx ~/logs
# Now ~/logs points to /var/log/nginx
```

---

### FOP-015 — Text Editors (Brief Intro)

**nano (Beginner-Friendly):**
```bash copy
nano file.txt
```
- `Ctrl+O` — save
- `Ctrl+X` — exit
- `Ctrl+K` — cut line
- `Ctrl+U` — paste

**vi/vim (Advanced):**
```bash copy
vi file.txt
```
- `i` — insert mode
- `Esc` — command mode
- `:w` — save
- `:q` — quit
- `:wq` — save and quit
- `:q!` — quit without saving

**When to Use:**
- **nano** — quick edits, beginner-friendly
- **vim** — powerful editing, worth learning for speed

</div>

</details>

---

<details>
<summary><strong>5. Real-World Scenarios</strong></summary>

<div style="margin-left: 16px; margin-right: 16px; margin-top: 8px; margin-bottom: 8px;">

### Scenario 1: Backup Config Files Before Editing

**Symptom:**
Need to edit `/etc/nginx/nginx.conf` but want backup.

**Cause:**
Changes might break config.

**Fix:**
```bash copy
sudo cp -iv /etc/nginx/nginx.conf /etc/nginx/nginx.conf.backup
sudo nano /etc/nginx/nginx.conf
```

**Confirm:**
```bash copy
ls -l /etc/nginx/*.conf*
# Output shows both files
```

---

### Scenario 2: Process All Log Files in Directory

**Symptom:**
Need to count "ERROR" in all `.log` files.

**Cause:**
Too many files to check manually.

**Fix:**
```bash copy
grep -c "ERROR" *.log
# OR save results:
grep -c "ERROR" *.log > error_counts.txt
```

**Confirm:**
```bash copy
cat error_counts.txt
# Output: filename:count for each log
```

---

### Scenario 3: Monitor Log File in Real-Time

**Symptom:**
Deployment running, need to watch application log.

**Cause:**
Need to see errors as they happen.

**Fix:**
```bash copy
tail -f /var/log/app/application.log
```

**Confirm:**
New log entries appear in real-time.
Press `Ctrl+C` to stop.

---

### Scenario 4: Copy Multiple Files Matching Pattern

**Symptom:**
Need to copy all `.conf` files to backup directory.

**Cause:**
Too many to copy individually.

**Fix:**
```bash copy
mkdir -p backup
cp -v *.conf backup/
```

**Confirm:**
```bash copy
ls backup/
# Output: all .conf files copied
```

---

### Scenario 5: Symbolic Link Broken After Move

**Symptom:**
Symlink shows red in `ls` output, doesn't work.

**Cause:**
Original file was moved or deleted.

**Fix:**
```bash copy
ls -l symlink
# Check where it points
rm symlink
ln -s /new/location/original.txt symlink
```

**Confirm:**
```bash copy
ls -l symlink
# Output: symlink -> /new/location/original.txt (works)
```

---

### Scenario 6: Capture Both Output and Errors

**Symptom:**
Script fails but error messages not captured.

**Cause:**
Only capturing stdout, not stderr.

**Fix:**
```bash copy
./deploy.sh > deploy.log 2>&1
# OR
./deploy.sh &> deploy.log
```

**Confirm:**
```bash copy
cat deploy.log
# Output: contains both stdout and stderr
```

</div>

</details>

---

<details>
<summary><strong>6. Commands Toolbox</strong></summary>

<div style="margin-left: 16px; margin-right: 16px; margin-top: 8px; margin-bottom: 8px;">

```bash copy
touch file.txt   # create empty file or update timestamp
```

```bash copy
file filename   # identify file type
```

```bash copy
stat filename   # show detailed file metadata
```

```bash copy
cp source.txt dest.txt   # copy file
```

```bash copy
cp -i source.txt dest.txt   # copy with prompt before overwrite
```

```bash copy
cp -v source.txt dest.txt   # copy with verbose output
```

```bash copy
cp -r src/ dest/   # copy directory recursively
```

```bash copy
cp -riv src/ dest/   # copy directory with interactive + verbose
```

```bash copy
mv old.txt new.txt   # rename file
```

```bash copy
mv file.txt /path/to/destination/   # move file
```

```bash copy
mv -iv source dest   # move with interactive + verbose
```

```bash copy
rm file.txt   # delete file
```

```bash copy
rm -i file.txt   # delete with confirmation prompt
```

```bash copy
rm -r directory/   # delete directory and contents
```

```bash copy
rm -rf directory/   # force delete without prompts (dangerous!)
```

```bash copy
cat file.txt   # print entire file
```

```bash copy
cat -n file.txt   # print with line numbers
```

```bash copy
tac file.txt   # print in reverse order
```

```bash copy
nl file.txt   # number lines
```

```bash copy
head file.txt   # show first 10 lines
```

```bash copy
head -n 20 file.txt   # show first 20 lines
```

```bash copy
tail file.txt   # show last 10 lines
```

```bash copy
tail -n 20 file.txt   # show last 20 lines
```

```bash copy
tail -f logfile.log   # follow log file in real-time
```

```bash copy
less file.txt   # page through file with navigation
```

```bash copy
ls *.txt   # list all .txt files
```

```bash copy
rm temp*   # delete all files starting with "temp"
```

```bash copy
cp *.log backup/   # copy all .log files to backup/
```

```bash copy
ls file?.txt   # match file1.txt, file2.txt, etc.
```

```bash copy
ls file[0-9].txt   # match file0.txt through file9.txt
```

```bash copy
command > output.txt   # redirect stdout to file (overwrite)
```

```bash copy
command >> output.txt   # redirect stdout to file (append)
```

```bash copy
command 2> errors.txt   # redirect stderr to file
```

```bash copy
command &> all.txt   # redirect both stdout and stderr
```

```bash copy
command > /dev/null 2>&1   # discard all output
```

```bash copy
cat file.txt | grep "error"   # pipe to grep
```

```bash copy
cat file.txt | grep "error" | wc -l   # chain multiple pipes
```

```bash copy
ln original.txt hardlink.txt   # create hard link
```

```bash copy
ln -s original.txt symlink.txt   # create symbolic link
```

```bash copy
nano file.txt   # edit file with nano
```

```bash copy
vi file.txt   # edit file with vi/vim
```

</div>

</details>

---

<details>
<summary><strong>7. Quick Summary</strong></summary>

<div style="margin-left: 16px; margin-right: 16px; margin-top: 8px; margin-bottom: 8px;">

- `touch` creates files, `mkdir` creates directories
- `cp` copies, `mv` moves/renames, `rm` deletes (permanent!)
- `cat` shows entire file, `less` pages through, `head`/`tail` show sections
- Globbing: `*` matches many chars, `?` matches one, `[]` matches set
- Redirection: `>` overwrites, `>>` appends, `2>` captures errors
- Pipes (`|`) chain commands together
- Hard links share inode, soft links point to filename
- Always use `-i` for interactive prompts on destructive operations
- `tail -f` follows log files in real-time
- File type indicator in `ls -l`: `-` = file, `d` = directory, `l` = link

**What's Next:**
Now that you can create and manage files, the next file covers users and groups — managing who can access the system and what they're part of.

</div>

</details>

---