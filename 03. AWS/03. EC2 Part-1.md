#  AWS EC2

## Table of Contents
1. [EC2 Basics](#1-ec2-basics)  
   - [What is EC2?](#11-what-is-ec2)  
   - [Billing and Pricing](#12-billing-and-pricing)  
   - [Free Tier EC2](#13-free-tier-ec2)  
   - [Storage and RAM Defaults](#14-storage-and-ram-defaults)  
   - [Amazon Machine Image (AMI)](#15-amazon-machine-image-ami)  
   - [Instance Types](#16-instance-types)  
   - [Key Pair](#17-key-pair)  
   - [Security Groups](#18-security-groups)  
2. [IP Types](#2-ip-types)  
   - [Private IP](#21-private-ip)  
   - [Public IP](#22-public-ip)  
   - [Elastic IP](#23-elastic-ip)  
3. [Elastic Block Store (EBS)](#3-elastic-block-store-ebs)  
   - [What is EBS?](#31-what-is-ebs)  
   - [EBS Volumes](#32-ebs-volumes)  
   - [Types of EBS Volumes](#33-types-of-ebs-volumes)  
   - [Practical Example](#34-practical-example)  
4. [4. Quick Revision Table](#4-quick-revision-table)
---

<details>
<summary><strong>1. EC2 Basics</strong></summary>

## 1.1 What is EC2?
EC2 stands for **Elastic Compute Cloud**. It is AWS’s service for creating virtual machines in the cloud.  

Think of it like renting a computer from AWS:
- You choose how much **RAM**, **CPU power**, and **storage** you want.  
- You can increase or decrease these resources as your workload changes (scalable).  

👉 Use cases:  
- Hosting a website  
- Running applications (databases, APIs, ML workloads)  
- Creating testing/development environments  

---

## 1.2 Billing and Pricing
AWS charges you based on **how long your EC2 instance is running**.  

- **Linux instances** → billed **per second** (minimum 60 seconds).  
- **Windows instances** → billed **per hour**.  

📌 Example:  
If you start a Linux instance at 10:00:00 and stop at 10:02:15, you are billed for **135 seconds**.  
For Windows, if you run for even 5 minutes, you are billed for the full **1 hour**.  

---

## 1.3 Free Tier EC2
AWS provides a **Free Tier** for new accounts:  
- 750 hours/month of EC2 usage for 12 months  
- Enough to run **one instance continuously** for the whole month  

Free instance types:  
- `t2.micro` → older, available in Asia regions  
- `t3.micro` → newer, available in US & Europe  

📌 Example: You can launch a free Ubuntu server (`t2.micro`) and practice hosting a small website.  

---

## 1.4 Storage and RAM Defaults
Every EC2 instance needs a **hard disk** to store the operating system and files. AWS uses **EBS (Elastic Block Store)** for this.  

- Default root volume sizes:  
  - Linux → **8 GB**  
  - Windows → **30 GB**  

⚠️ Important: The **RAM** is decided by the **instance type**, not the OS.  
- Example: `t2.micro` = 1 GB RAM, `t3.medium` = 4 GB RAM.  

📌 Analogy: Think of EBS as your **hard drive**, and RAM as your **computer’s memory** — two different things.  

---

## 1.5 Amazon Machine Image (AMI)
An **AMI** is like a **template** for your EC2 instance. It contains:  
- The operating system (Windows, Linux, Ubuntu, etc.)  
- Pre-installed software (optional)  
- Default settings  

📌 Example:  
- Want a Linux server? → Choose Ubuntu AMI  
- Want a Windows desktop? → Choose Windows AMI  

---

## 1.6 Instance Types
AWS offers **different categories of instances** depending on what you need:  
- **General Purpose** → balanced (web apps)  
- **Compute Optimized** → more CPU (batch processing)  
- **Memory Optimized** → more RAM (databases, analytics)  
- **GPU Instances** → for ML, AI, gaming  

Free Tier examples:  

| Instance | Region      | Free Tier |  
|----------|-------------|-----------|  
| t2.micro | Asia        | Yes       |  
| t3.micro | US, Europe  | Yes       |  

📌 Example: If you just want to practice Linux commands, you don’t need GPU/memory-heavy instances — `t2.micro` is enough.  

---

## 1.7 Key Pair
When you connect to your EC2 via SSH (Linux/Mac) or RDP (Windows), AWS uses **Key Pairs** for authentication.  

- You download a **private key file** when you create the key pair:  
  - On Linux/Mac: `.pem` file  
  - On Windows (PuTTY): `.ppk` file (converted from `.pem`)  
- The **public key** is stored inside the EC2 instance automatically.  
- Together they work like a **lock and key system**.  

📌 Secure the private key with:  
```bash
chmod 400 mykey.pem
````

Without correct permissions, SSH won’t connect.

---

### 🔑 Key Pair Authentication Flow

```
[ Your PC ] -- uses private key --> [ SSH Request ] ---> [ EC2 Instance ]
                                           |
                                           v
                              EC2 compares with public key
                                           |
                       +-------------------+-----------------+
                       | Match? YES -> Access Granted        |
                       | Match? NO  -> Access Denied         |
                       +-------------------------------------+
```

---

## 1.8 Security Groups

A **Security Group** is like a **firewall** that controls traffic to and from your EC2 instance.

* **Inbound rules** → define what traffic can come **into** the instance
* **Outbound rules** → define what traffic can leave (default = all allowed)
* **Stateful** → if inbound is allowed, the reply outbound is automatically allowed

✔️ Common rules:

* Allow HTTP (port 80) → normal websites
* Allow HTTPS (port 443) → secure websites
* Allow SSH (port 22) → remote login

📌 Example:

* Hosting a website? → Open port 80 and 443 inbound
* Need remote login? → Open port 22 for your IP

---

### 🔒 Security Group Traffic Flow

```
          [ User's Browser ]
                 |
     HTTP Request on port 80
                 |
                 v
+-------------------------------+
| Security Group (EC2 Firewall) |
| Inbound Rules: Allow 80, 443  |
+-------------------------------+
                 |
                 v
           [ EC2 Instance ]
                 |
     Sends back website response
                 |
  (Outbound allowed automatically)
                 v
          [ User's Browser ]
```

</details>

---

<details>
<summary><strong>2. IP Types</strong></summary>

When you launch an **EC2 (Elastic Compute Cloud)** instance in AWS, it automatically gets IP addresses that allow communication within AWS and with the internet.
Every instance inside a **VPC (Virtual Private Cloud)** has:

* **Private IP** → used for internal communication within AWS
* **Public IP** → used for internet access
* **Elastic IP** → optional static public IP that never changes

---

### 2.1 Private IP

* Assigned automatically when you launch an EC2 instance inside a VPC.
* Used for **internal communication** between AWS resources (e.g., EC2 ↔ RDS).
* **Persists** when an instance is stopped and started again.
* **Released** only when the instance is terminated.
* **Free of cost** and **not routable on the internet**.

📘 **Example:**

```
Instance A → Private IP: 10.0.0.5
Instance B → Private IP: 10.0.0.8
```

Both instances can communicate internally within the VPC using their private IPs.

💡 **Analogy:**
A private IP is like your **house number** inside an apartment complex — visible only to residents inside.

---

### 2.2 Public IP

* Assigned automatically when you launch an instance in a **public subnet**.
* Allows your instance to **communicate with the internet**.
* **Dynamic (floating):** changes every time the instance is stopped and started.
* **Released automatically** when the instance stops or terminates.
* **Used for:** SSH, HTTP, and HTTPS connections.
* **Cost:** billed under AWS’s **Public IPv4** pricing. Free Tier includes 750 hours/month of in-use public IPv4.

📘 **Example:**

```
Private IP: 10.0.0.12
Public IP: 3.120.55.23
```

Connect from your computer:

```bash
ssh -i mykey.pem ec2-user@3.120.55.23
```

After restarting the instance, a new public IP (e.g., `13.210.40.50`) will be assigned.

💡 **Analogy:**
A public IP is like a **mobile number** — anyone can reach you, but it may change if you restart your service.

---

### 2.3 Elastic IP

* A **static (fixed) public IPv4 address** that you allocate manually.
* Remains the same even after stopping or restarting the instance.
* Useful for **production servers** that require a constant public address.
* Can be **detached** and reassigned to another instance if needed.
* **Free** when associated with a running instance.
* **Billed** if allocated but not in use (idle).

📘 **Example:**

```
Elastic IP: 18.220.45.90
Associated Instance: EC2-Web-Server
```

Even after restart, it remains the same:

```
Elastic IP: 18.220.45.90 ✅ (Permanent)
```

💡 **Analogy:**
An elastic IP is like a **business landline** — a permanent number that never changes, even if you move offices.

---

### ⚙️ Workflow

1. Go to **AWS EC2 Console → Elastic IPs**
2. Click **Allocate Elastic IP address**
3. Choose **VPC scope** → **Allocate**
4. Click **Actions → Associate Elastic IP address**
5. Select your **Instance ID** → **Associate**
6. **Release** it later if not required to avoid idle charges

---

### 📊 Comparison Table

| IP Type        | Static/Dynamic    | Scope          | Cost                                      | Behavior                                     | Example Use Case                     |
| -------------- | ----------------- | -------------- | ----------------------------------------- | -------------------------------------------- | ------------------------------------ |
| **Private IP** | Static (persists) | Internal (VPC) | Free                                      | Same after stop/start; released on terminate | Internal AWS communication           |
| **Public IP**  | Dynamic           | Internet       | Free up to 750 hrs/mo; billed beyond that | Changes after stop/start; released on stop   | Temporary internet access            |
| **Elastic IP** | Static            | Internet       | Free if attached; billed if idle or extra | Fixed; transferable between instances        | Permanent IP for websites or servers |

---



                    ┌────────────────────────────┐
                    │       Internet User        │
                    │ (e.g., You on a Laptop)    │
                    └──────────────┬─────────────┘
                                   │
                     Uses Public IP or Elastic IP
                                   │
                      (Example: 3.120.55.23 or 18.220.45.90)
                                   │
                     ┌─────────────▼──────────────┐
                     │   Internet Gateway (IGW)   │
                     │  Bridges Internet <-> VPC  │
                     └─────────────┬──────────────┘
                                   │
                           Public Subnet
                                   │
                  ┌────────────────┴────────────────┐
                  │                                 │
          ┌───────▼───────┐                 ┌───────▼───────┐
          │  EC2 Instance │                 │  EC2 Instance │
          │   Web Server  │                 │   Database    │
          │               │                 │               │
          │ Public IP: 3.120.55.23          │ No Public IP  │
          │ Elastic IP: 18.220.45.90 (opt)  │ Private Only  │
          │ Private IP: 10.0.0.12           │ Private IP: 10.0.0.8 │
          └──────────────────────────────────────────────────────┘
                                   │
                      Communicate privately via VPC
                                   │
                         (10.0.0.12 ↔ 10.0.0.8)


</details>

---

<details>
<summary><strong>3. Elastic Block Store (EBS)</strong></summary>

### 3.1 What is EBS?

* **Elastic Block Store (EBS)** is block-level storage used with EC2 instances.
* Works like a **virtual hard disk (HDD/SSD)**.
* Persistent → data survives instance stop/start.
* Each EC2 instance must have at least **one root volume** (boot disk).

---

### 3.2 EBS Volumes

* Root volume → default OS storage.

  * Linux default: **8 GiB**
  * Windows default: **30 GiB**
* Additional volumes can be attached/detached.
* Volume size → up to **16 TiB**.
* One EC2 instance can have **multiple volumes**.

---

### 3.3 Types of EBS Volumes

| Type                               | Description                      | Use Case            | Min Size | Max Size |
| ---------------------------------- | -------------------------------- | ------------------- | -------- | -------- |
| **gp3 (General Purpose SSD)**      | Balanced performance & price     | General workloads   | 1 GiB    | 16 TiB   |
| **io2/io1 (Provisioned IOPS SSD)** | High performance, low latency    | Databases           | 4 GiB    | 16 TiB   |
| **st1 (Throughput Optimized HDD)** | Low-cost HDD, high throughput    | Big data, streaming | 125 GiB  | 16 TiB   |
| **sc1 (Cold HDD)**                 | Cheapest HDD, lowest performance | Archival data       | 125 GiB  | 16 TiB   |
| **Magnetic (Standard)**            | Legacy HDD                       | Rarely used         | 1 GiB    | 1 TiB    |

---

### 3.4 Example – Using Additional Volumes Across Instances

#### Step 1: Store Data into the Additional Volume

```bash
# Format the new volume
sudo mkfs -t ext4 /dev/xvdbb

# Create a directory to mount
mkdir telusko

# Mount the volume
sudo mount /dev/xvdbb telusko

# Go inside the mount directory
cd telusko

# Create files inside the new volume
sudo touch telusko.txt alien.txt
```

At this point, your extra volume (`/dev/xvdbb`) contains 2 files.

---

#### Step 2: Detach Additional Volume

* From the AWS console, **detach the additional volume** from the current EC2 VM.

---

#### Step 3: Attach Volume to Another Instance

1. Create a **new EC2 VM**.
2. Attach the same additional volume (`/dev/xvdbb`) to the new VM.

---

#### Step 4: Verify Data in New Instance

```bash
# Check available block devices
lsblk

# Create mount point again
mkdir telusko

# Mount the existing volume
sudo mount /dev/xvdbb telusko

# Go inside and list files
cd telusko
ls -l
```

📌 You should see the files created earlier:

```
telusko.txt
alien.txt
```

---

#### Step 5: Cleanup

* Once done with practice, **detach the additional volumes**.
* Delete the volume from AWS console if no longer needed.

---

### 📊 Visual

```
[ EC2 Instance A ] --> Volume (/dev/xvdbb) --> Files: telusko.txt, alien.txt
       |
   Detach Volume
       v
[ EC2 Instance B ] <-- Attach same volume <-- Files still available
```
</details>

---

<details>
<summary><strong>4. Quick Revision Table</strong></summary>

| Concept        | Key Point                        | Analogy                       |
| -------------- | -------------------------------- | ----------------------------- |
| EC2            | Virtual machine in AWS           | Renting a computer            |
| Billing        | Linux = per sec, Win = per hour  | Pay-as-you-go                 |
| Free Tier      | 750 hrs/month (t2/t3.micro)      | 1 free server 24/7 for a year |
| AMI            | Template (OS + software)         | Prebuilt OS image             |
| Key Pair       | `.pem/.ppk` login keys           | Lock + Key                    |
| Security Group | Firewall, inbound/outbound rules | Bouncer at the door           |
| Private IP     | Internal only                    | Home Wi-Fi address            |
| Public IP      | Internet, temporary              | Phone number that can change  |
| Elastic IP     | Internet, permanent              | Business landline             |
| EBS            | Persistent block storage         | Hard drive for EC2            |
| gp3            | Balanced SSD                     | Laptop SSD                    |
| io2            | High perf SSD                    | Enterprise SSD                |
| st1            | High throughput HDD              | External movie drive          |
| sc1            | Cold storage HDD                 | Old backup drive              |

---

</details>