# AWS EC2 ‚Äì Complete Notes

We now understand storage ‚Äî both local (EBS) and global (S3).
But storage by itself doesn‚Äôt process anything.
We need the engine that runs our code and powers our apps.
That engine is EC2 (Elastic Compute Cloud) ‚Äî the virtual machine that ties IAM, VPC, and storage into one working system.

## Table of Contents

1. [EC2 Overview & Purpose](#1-ec2-overview--purpose)  
2. [Billing & Pricing Models](#2-billing--pricing-models)  
3. [AMI & Instance Types](#3-ami--instance-types)  
4. [EC2 Lifecycle & States](#4-ec2-lifecycle--states)  
5. [Key Pairs & Security Groups](#5-key-pairs--security-groups)  
6. [Understanding VPC & Subnets](#6-understanding-vpc--subnets)  
7. [IP Concepts (Private, Public, Elastic, ENI)](#7-ip-concepts-private-public-elastic-eni)  
8. [Storage (EBS, Snapshots, FSR, Archive, Cross-AZ/Region Patterns)](#8-storage-ebs-snapshots-fsr-archive-cross-azregion-patterns)  
9. [Web Hosting (httpd) & User Data](#9-web-hosting-httpd--user-data)  
10. [Instance Metadata & Identity (IMDSv2, Signed Docs, Role Creds)](#10-instance-metadata--identity-imdsv2-signed-docs-role-creds)  
11. [Networking Foundations (DNS, TCP/UDP, OSI vs TCP/IP)](#11-networking-foundations-dns-tcpudp-osi-vs-tcpip)  
12. [Load Balancer (with Health Checks)](#12-load-balancer-with-health-checks)  
13. [Auto Scaling & Monitoring](#13-auto-scaling--monitoring)

---

<details>
<summary><strong>1. EC2 Overview & Purpose</strong></summary>

### What is EC2?

EC2 stands for **Elastic Compute Cloud**, AWS‚Äôs service for creating virtual machines in the cloud.
‚ÄúElastic‚Äù means you can increase or decrease compute capacity on demand ‚Äî like stretching or shrinking a rubber band depending on workload.   
It allows you to rent compute capacity from AWS instead of owning physical servers.  
You decide how much **CPU**, **memory**, and **storage** you need ‚Äî and can scale up or down anytime.

**Use Cases:**
- Hosting websites and APIs  
- Running databases or backend servers  
- Testing and development environments  
- Machine learning workloads  

**Analogy:**  
Think of AWS as a massive data center. EC2 lets you rent one computer inside it ‚Äî and you can turn it on, off, or resize it anytime.

üì∏ **Image:** [AWS EC2 Concepts](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/concepts.html)

</details>

---

<details>
<summary><strong>2. Billing & Pricing Models</strong></summary>

### EC2 Billing Basics

You pay for the **time your instance is running**:
- **Linux:** billed **per second** (minimum 60 seconds)  
- **Windows:** billed **per hour**

**Example:**  
Run a Linux instance for 2 minutes 15 seconds ‚Üí billed for **135 seconds**.  
Windows instances ‚Üí billed for the full **hour** even if used for 5 minutes.

---

### Free Tier

AWS Free Tier gives:
- **750 hours/month for 12 months**  
- Enough to run one small instance continuously  

**Instance types:**  
- `t2.micro` (older, available in Asia regions)  
- `t3.micro` (newer, available in US/EU regions)  

---

### Pricing Models

| Model | Description | When to Use |
|-------|--------------|-------------|
| **On-Demand** | Pay by second/hour. No commitment. | Testing, short workloads |
| **Reserved Instances (RI)** | 1‚Äì3 year commitment for up to 72% discount. | Long-running production workloads |
| **Spot Instances** | Use spare AWS capacity, up to 90% cheaper. | Fault-tolerant workloads |
| **Savings Plans** | Commit to $/hour usage, flexible across services. | Predictable workloads |
| **Dedicated Hosts** | Physical server reserved just for you. | Compliance or licensing needs |

> üí° **Note:**  
> - **Linux instances** are billed **per-second** (minimum 60 s).  
> - **Windows instances** are billed **per hour**.  
> - **Public IPv4 addresses** are now **billable** outside the Free Tier.  
>   The Free Tier covers **750 hours / month** of one public IPv4; additional or idle ones incur charges.  
> - **Elastic IP (EIP)** addresses are **free while attached** to a running instance, but **billed when idle** (allocated but unused).

üì∏ **Image:** [AWS EC2 Pricing](https://aws.amazon.com/ec2/pricing/)

</details>

---

<details>
<summary><strong>3. AMI & Instance Types</strong></summary>

### Amazon Machine Image (AMI)

An AMI is a **template** used to launch EC2 instances.  
It includes:
- Operating System (Linux, Windows, Ubuntu, etc.)
- Preinstalled software (optional)
- Configurations and permissions  

**Examples:**
- Ubuntu Server AMI ‚Üí ready-to-use Linux machine  
- Windows Server AMI ‚Üí preconfigured Windows environment  

---

### Instance Types

| Family | Optimized For | Example | Use Case |
|---------|----------------|----------|-----------|
| **General Purpose** | Balanced CPU/RAM | `t3.micro` | Web servers |
| **Compute Optimized** | High CPU | `c5.large` | Batch processing |
| **Memory Optimized** | High RAM | `r5.large` | Databases |
| **Storage Optimized** | High I/O | `i3.large` | Data warehousing |
| **Accelerated (GPU)** | Graphics / ML | `p3.2xlarge` | AI/ML workloads |

**Analogy:**  
Each instance type is like a car built for a purpose ‚Äî a sports car for speed, a truck for heavy loads, etc.

üì∏ **Image:** [AWS Instance Types](https://aws.amazon.com/ec2/instance-types/)

</details>

---

<details>
<summary><strong>4. EC2 Lifecycle & States</strong></summary>

### Lifecycle Stages

| State | Description |
|--------|--------------|
| **Pending** | Preparing resources and booting |
| **Running** | Fully operational and billable |
| **Stopping** | OS shutting down gracefully |
| **Stopped** | Not running, storage billed but compute stops |
| **Terminated** | Deleted permanently |

**Analogy:**  
Think of EC2 like a laptop:  
- Booting ‚Üí Pending  
- Working ‚Üí Running  
- Sleep ‚Üí Stopped  
- Factory reset ‚Üí Terminated  

üì∏ **Image:**  
<img src="images/EC2_instance_lifecycle.png" alt="EC2 Lifecycle" width="550"/>

</details>

---

<details>
<summary><strong>5. Key Pairs & Security Groups</strong></summary>

### Key Pair Authentication

When you create an EC2 instance, AWS uses **public-key cryptography** to ensure secure access ‚Äî just like how every home has its own unique lock and key.

**Analogy:**  
If your **EC2 instance is your home**:
- The **public key** is the **lock** installed on the home‚Äôs door (AWS automatically adds it to your instance).  
- The **private key file** (`.pem` or `.ppk`) that **you download** is the **key** that fits that lock.  

You need this private key every time you want to enter (connect via SSH or RDP).  
If the key doesn‚Äôt match the lock ‚Üí you can‚Äôt get inside.

---

#### Example: Connecting to EC2 (Linux/macOS)

```bash
# Step 1: Secure your private key
chmod 400 mykey.pem

# Step 2: Connect to your EC2 instance using SSH
ssh -i mykey.pem ec2-user@<Public-IP>
````

If the **private key** matches the **public key lock** on the instance:
‚úÖ Access granted ‚Äî you‚Äôve entered your EC2 ‚Äúhome.‚Äù

If not:
‚ùå Permission denied ‚Äî wrong or missing key.

üì∏ **Image:** [AWS EC2 Key Pairs](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ec2-key-pairs.html)

---

### Security Groups (SG)

A Security Group acts as a **virtual firewall**.

* **Inbound rules** ‚Üí what traffic can enter
* **Outbound rules** ‚Üí what traffic can exit
* **Stateful** ‚Üí return traffic automatically allowed

| Protocol | Port | Use Case           |
| -------- | ---- | ------------------ |
| SSH      | 22   | Remote login       |
| HTTP     | 80   | Web traffic        |
| HTTPS    | 443  | Secure web traffic |

üì∏ **Image:** [VPC Security Groups](https://docs.aws.amazon.com/vpc/latest/userguide/VPC_SecurityGroups.html)

</details>

---

<details>
<summary><strong>6. Understanding VPC & Subnets</strong></summary>

---

## üåç AWS as a Planet ‚Äì The Big Picture

Before learning about IPs, it‚Äôs important to understand **where** everything in AWS lives.

Think of **AWS** as a **digital planet** made up of continents (Regions) and cities (Availability Zones).  
On this planet, every user can carve out their own **private island**, completely isolated from others ‚Äî that island is your **VPC (Virtual Private Cloud)**.

---

### üèùÔ∏è 1. What is a VPC?

A **VPC (Virtual Private Cloud)** is your **own private island** on the AWS planet.  
It‚Äôs a completely secure and customizable environment where you host your AWS resources such as EC2 instances, databases, and load balancers.

Inside this island, you control:
- **Borders:** IP address range (e.g., `10.0.0.0/16`)  
- **Security:** Who can enter or leave (Security Groups, NACLs, Route Tables)  
- **Connectivity:** Whether to open your island to the ocean (Internet) or stay isolated  

**Analogy:**  
> Think of a VPC as your **private country or island** in the AWS world.  
> You make the rules, build the infrastructure, and decide who can visit or communicate.

---

### üß± 2. What is a Subnet?

A **Subnet** is a smaller **district or region** inside your private island (VPC).  
You divide your island into multiple subnets to separate workloads based on their accessibility.

Each subnet exists within one **Availability Zone (AZ)** ‚Äî meaning if you have 3 AZs in your AWS Region, your island can have 3 major districts (subnets) across them.

| Subnet Type | Analogy | Connectivity | Common Use |
|--------------|----------|--------------|-------------|
| **Public Subnet** | Coastal city with open ports | Connected to the **Internet Gateway (IGW)** | Web servers, Bastion hosts |
| **Private Subnet** | Inland city with guarded roads | No direct internet connection (internal only) | Databases, Application servers |

---

### üß© 3. How They Work Together

1. The **VPC** provides your island (the overall network boundary).  
2. You divide it into **Subnets** ‚Äî each district serving a purpose (public or private).  
3. You connect a **Public Subnet** to the **Internet Gateway** ‚Äî allowing outside traffic to visit.  
4. You keep **Private Subnets** isolated ‚Äî only accessible through internal connections.

---

### üí° Planet Analogy Summary

| AWS Concept | Real-World Analogy | Description |
|--------------|--------------------|--------------|
| **AWS Cloud** | The entire planet | Global infrastructure shared by all AWS users |
| **Region** | Continent | Large geographic area (e.g., North America, Asia) |
| **Availability Zone (AZ)** | City on a continent | Data center cluster within a region |
| **VPC** | Private island or country | Your own isolated network on the AWS planet |
| **Subnet** | District or region on your island | Divides your island into zones for specific use |
| **Public Subnet** | Coastal city with ports | Internet-facing zone for public services |
| **Private Subnet** | Inland city or lab | Internal-only zone for secure data storage |

---

### üñºÔ∏è Visual Diagram

```
                üåç AWS Planet
                       ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ                         ‚îÇ
  (Other Users‚Äô Islands)     üèùÔ∏è Your VPC (Private Island)
                                     ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ                                                     ‚îÇ
 üåä Public Subnet (Coastal City)                     üèûÔ∏è Private Subnet (Inland City)
  - Connected to Internet Gateway                    - No direct internet access
  - Hosts Web Servers                                - Hosts Databases & Internal Apps
  - Has Public & Private IPs                         - Has only Private IPs
```

---

### üß† One-Line Takeaway

> **AWS is the Planet üåç**  
> **VPC is your Private Island üèùÔ∏è**  
> **Subnets are the Districts or Zones on that Island üß±**  
> **Public Subnets face the sea (Internet Gateway), while Private Subnets stay inland (internal communication).**

üì∏ **Reference:**  
[AWS VPC Overview ‚Äì Official Documentation](https://docs.aws.amazon.com/vpc/latest/userguide/what-is-amazon-vpc.html)

---

</details>

---

<details>
<summary><strong>7. IP Concepts (Private, Public, Elastic, ENI)</strong></summary>

## üåê IP Concepts ‚Äì Addresses on Your Island

Every EC2 instance inside your **VPC (Private Island)** needs a way to communicate ‚Äî both **within the island** and **with the outside world**.  
That‚Äôs where **IP addresses** come in.  

Each EC2 instance can have:
- **Private IP** ‚Üí used within your island (local communication)
- **Public IP** ‚Üí used to connect with the outside ocean (internet)
- **Elastic IP** ‚Üí a permanent public address (reserved port)
- **ENI (Elastic Network Interface)** ‚Üí the network card that holds these addresses

---

### üß© 1. Private IP ‚Äì The House Address Inside the Island

Whenever you build a house (launch an EC2 instance) on your island, AWS automatically assigns it a **Private IP address**.  

This address is used for **internal communication** ‚Äî  
for example, your bakery (web server) talking to your storage warehouse (database) ‚Äî all within your fenced island.  

A Private IP **stays the same** even if you restart the house‚Äôs power (stop/start the instance),  
but it is **released permanently** if you demolish the house (terminate the instance).  

Private IPs are **free of cost** and **not visible from the ocean (internet)** ‚Äî they work only within your island‚Äôs local boundaries.

üìò **Example**
```

Instance A ‚Üí Private IP: 10.0.0.5
Instance B ‚Üí Private IP: 10.0.0.8

```

Both houses can exchange letters (data) freely because they live inside the same fenced island (VPC).

üí° **Analogy:**  
A **Private IP** is your **house address inside the island** ‚Äî neighbors can visit you,  
but no ship sailing on the ocean can see or reach you.

üì∏ **Image:** [Private IP Addressing in EC2](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-ip-addressing.html)

---

### üåä 2. Public IP ‚Äì The Dock Facing the Ocean

When you build something on your island that the world should reach ‚Äî like a tourist information center or a shop ‚Äî you place it on the **coastline** (Public Subnet).  
AWS then assigns it a **Public IP address** connected to an **Internet Gateway (IGW)**.

This Public IP allows visitors (users on the internet) to find and access your service.

However, this dock address is **temporary (dynamic)** ‚Äî  
if you close the port and reopen it (stop/start your instance), the city assigns a **new dock number** next time.  
If you shut down the port completely (terminate the instance), the old number is gone forever.

Public IPs are billed under AWS‚Äôs **Public IPv4** pricing, but the **Free Tier** covers 750 hours per month.

üìò **Example**
```

Private IP: 10.0.0.12
Public IP: 3.120.55.23

````

Connect using SSH:
```bash
ssh -i mykey.pem ec2-user@3.120.55.23
````

After restarting, AWS might give you a new address, like `13.210.40.50`.

üí° **Analogy:**
A **Public IP** is your **temporary dock number** ‚Äî ships (internet users) can reach you through it,
but if you rebuild or move your dock, the number changes.

üì∏ **Image:** [Public IPv4 Addressing in EC2](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-ip-addressing.html)

---

### ‚öì 3. Elastic IP ‚Äì The Permanent Trade Port

Sometimes, you don‚Äôt want your dock number (Public IP) to change ‚Äî especially if you run a permanent business on your island, like a trading company (production server).
That‚Äôs where an **Elastic IP (EIP)** comes in.

An Elastic IP is a **static (permanent) public IPv4 address** that you reserve manually.
It stays the same even if your instance stops, restarts, or moves.
You can **detach it** from one instance and **reassign it** to another anytime.

Elastic IPs are **free while attached**, but **billed if idle** (when allocated but unused).

üìò **Example**

```
Elastic IP: 18.220.45.90
Associated Instance: EC2-Web-Server
```

Even after restart:

```
Elastic IP: 18.220.45.90 ‚úÖ (Permanent)
```

üí° **Analogy:**
An **Elastic IP** is your **island‚Äôs registered trade port** ‚Äî
a permanent harbor number used for global trade.
Even if you rebuild your warehouse or relocate offices, ships (clients) always find you through the same port number.

üì∏ **Image:** [Elastic IP in EC2](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-ip-addressing.html)

---

### üõ∞Ô∏è 4. ENI (Elastic Network Interface) ‚Äì The Island‚Äôs Communication Hub

An **ENI** is like the **communication control center** of each building on your island.
It‚Äôs a **virtual network card** that stores your Private IP, Public IP (if any), and connection rules (Security Groups).

You can **attach or detach** ENIs between instances, like swapping communication panels between buildings.
They‚Äôre essential for fault-tolerant or multi-network designs.

üí° **Analogy:**
An **ENI** is the **telecom hub** in your building ‚Äî
it manages all your phone lines, radios, and ports, connecting you to other buildings or even other islands.

üì∏ **Image:** [Elastic Network Interface (ENI)](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/using-eni.html)

---

### üß≠ Comparison Summary

| IP Type        | Role on the Island      | Persistence         | Cost                             | Analogy                           |
| -------------- | ----------------------- | ------------------- | -------------------------------- | --------------------------------- |
| **Private IP** | Internal communication  | Persists on restart | Free                             | House address inside the island   |
| **Public IP**  | Internet-facing access  | Changes on restart  | Free (within 750 hrs/mo)         | Temporary dock number             |
| **Elastic IP** | Permanent global access | Fixed and reusable  | Free if attached; billed if idle | Registered trade port             |
| **ENI**        | Network connector       | N/A                 | Free                             | Communication hub in the building |

---

### üñºÔ∏è Visual Diagram

```
üåç AWS Planet
‚îÇ
‚îî‚îÄ‚îÄ üèùÔ∏è Your VPC (Private Island)
     ‚îÇ
     ‚îú‚îÄ‚îÄ üåä Public Subnet (Coastal City)
     ‚îÇ     ‚îú‚îÄ‚îÄ EC2 Instance with Public IP (Dock Access)
     ‚îÇ     ‚îî‚îÄ‚îÄ EC2 Instance with Elastic IP (Permanent Port)
     ‚îÇ
     ‚îî‚îÄ‚îÄ üèûÔ∏è Private Subnet (Inland City)
           ‚îú‚îÄ‚îÄ EC2 Instance with Private IP (Internal Roads)
           ‚îî‚îÄ‚îÄ ENI (Communication Hub connecting everything)
```


                    ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                    ‚îÇ       Internet User        ‚îÇ
                    ‚îÇ (e.g., You on a Laptop)    ‚îÇ
                    ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   ‚îÇ
                     Uses Public IP or Elastic IP
                                   ‚îÇ
                      (Example: 3.120.55.23 or 18.220.45.90)
                                   ‚îÇ
                     ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                     ‚îÇ   Internet Gateway (IGW)   ‚îÇ
                     ‚îÇ  Bridges Internet <-> VPC  ‚îÇ
                     ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   ‚îÇ
                           Public Subnet
                                   ‚îÇ
                  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
                  ‚îÇ                                 ‚îÇ
          ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê                 ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
          ‚îÇ  EC2 Instance ‚îÇ                 ‚îÇ  EC2 Instance ‚îÇ
          ‚îÇ   Web Server  ‚îÇ                 ‚îÇ   Database    ‚îÇ
          ‚îÇ               ‚îÇ                 ‚îÇ               ‚îÇ
          ‚îÇ Public IP: 3.120.55.23          ‚îÇ No Public IP  ‚îÇ
          ‚îÇ Elastic IP: 18.220.45.90 (opt)  ‚îÇ Private Only  ‚îÇ
          ‚îÇ Private IP: 10.0.0.12           ‚îÇ Private IP: 10.0.0.8 ‚îÇ
          ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                   ‚îÇ
                      Communicate privately via VPC
                                   ‚îÇ
                         (10.0.0.12 ‚Üî 10.0.0.8)

üì∏ **Reference:**
[AWS EC2 Networking ‚Äì IP Addressing](https://docs.aws.amazon.com/vpc/latest/userguide/vpc-ip-addressing.html)

</details>

---

<details>
<summary><strong>8. Storage (EBS, Snapshots, Cross-AZ/Region Copy)</strong></summary>

---

## Elastic Block Store (EBS)

EBS is the **hard disk** of your EC2 instance.  
Even if you stop or restart the machine, the data stays safe ‚Äî that‚Äôs what makes it **persistent**.

Each EBS volume acts like one **virtual drive** attached to your instance.  
You can remove it, re-attach it, or copy it to another zone.

| Type        | Description        | Best For |
|-------------|--------------------|----------|
| **gp3**     | Balanced SSD       | General workloads |
| **io2/io1** | High IOPS SSD      | Databases, latency-sensitive apps |
| **st1**     | Throughput HDD     | Big sequential data like logs, analytics |
| **sc1**     | Cold HDD           | Rarely accessed, archive data |

üí° **Analogy:**  
Think of EBS as a **warehouse of shelves** on your island.  
Each shelf (volume) holds your goods (data).  
You can move shelves between shops (instances) ‚Äî but only inside the **same district (Availability Zone)**.

üì∏ **Reference:** [Amazon EBS Volumes](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes.html)

---

## Snapshots

A **snapshot** is a photograph of your shelf at a certain moment.  
AWS stores it in S3 internally, so you can rebuild the same shelf whenever needed.

```
EBS Volume ‚Üí Snapshot ‚Üí New Volume
```

- First snapshot = full copy  
- Next ones = only changed blocks (incremental)  
- You can restore, copy, or automate them with **Lifecycle Manager**

üí° **Analogy:**  
Take a **photo of your warehouse shelf** today.  
If something breaks tomorrow, you can rebuild an identical shelf using that photo.

üì∏ **Reference:** [EBS Snapshots](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSSnapshots.html)

---

## Cross-AZ or Cross-Region Copy

**Within same Region (Cross-AZ):**

1. Take a snapshot of volume in `us-east-1a`  
2. Create a new volume from it in `us-east-1b`  
3. Attach it to an instance there  

**Between Regions:**

1. Copy snapshot to another region  
2. Create volume from that copy  
3. Attach it to an instance in that region  

üí° **Analogy:**  
You take the photo of your shelf, fly it to another **city (AZ)** or even another **continent (Region)**,  
and rebuild the same shelf there.

üì∏ **Reference:** [Copy Snapshots](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-copy-snapshot.html)

</details>

---

<details>
<summary><strong>9. Web Hosting (httpd) & User Data</strong></summary>

---

## Hosting a Simple Website on EC2

You can turn your EC2 into a small web server using **Apache HTTPD**.

**Step 1 ‚Äì Install Apache**

```bash
sudo yum install -y httpd
````

**Step 2 ‚Äì Start the service**

```bash
sudo systemctl start httpd
sudo systemctl enable httpd
```

**Step 3 ‚Äì Allow Traffic**

In your Security Group, open:

* **HTTP (80)**
* **HTTPS (443)**

**Step 4 ‚Äì Create a Web Page**

```bash
cd /var/www/html
sudo bash -c 'echo "<h1>Telusko DevOps Learning</h1>" > index.html'
```

Now visit `http://<Public-IP>` in your browser.

üí° **Analogy:**
Your EC2 is a **caf√©**, and Apache is the **waiter** serving pages to visitors who walk in through the **front door (port 80/443)**.

üì∏ **Reference:** [Install LAMP on EC2](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/install-LAMP.html)

---

## User Data ‚Äì Automation on First Boot

**User Data scripts** run only once when a new instance starts.
They‚Äôre used for quick setup ‚Äî installing software or creating files automatically.

```bash
#!/bin/bash
yum install -y httpd
echo "<h1>ATD Learning App ‚Äì 1</h1>" > /var/www/html/index.html
systemctl enable httpd
systemctl start httpd
```

üí° **Analogy:**
This is like your **‚Äúopening-day checklist‚Äù** pinned to the caf√© door ‚Äî
each new branch runs it automatically before serving customers.

üì∏ **Reference:** [EC2 User Data](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/user-data.html)

</details>

---

<details>
<summary><strong>10. Instance Metadata & Identity Document</strong></summary>

---

## Instance Metadata ‚Äì Facts About Your Instance

This is a local HTTP endpoint inside every EC2 that gives information about itself.
It‚Äôs only reachable **from within** the instance.

```bash
curl http://169.254.169.254/latest/meta-data/
```

Examples:

* `public-ipv4`
* `instance-id`
* `security-groups`
* `ami-id`

üí° **Analogy:**
Inside your house, there‚Äôs a **cabinet with blueprints** ‚Äî it shows everything about the house,
but no outsider can open it.

---

## IMDSv2 (Security Upgrade)

Newer version of metadata service uses **session tokens** for safety.
AWS recommends **enforcing IMDSv2 only**.

```bash
TOKEN=$(curl -X PUT "http://169.254.169.254/latest/api/token" \
  -H "X-aws-ec2-metadata-token-ttl-seconds: 21600")

curl -H "X-aws-ec2-metadata-token: $TOKEN" \
  http://169.254.169.254/latest/meta-data/
```

---

## Instance Identity Document

Signed JSON document that proves which instance you are.

```bash
curl http://169.254.169.254/latest/dynamic/instance-identity/document
```

Shows:

* Region
* Instance ID
* AMI ID
* Account ID

üí° **Analogy:**
It‚Äôs your **government-issued house deed** ‚Äî official proof of who you are on the island.

üì∏ **Reference:** [Instance Metadata Docs](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/instancedata-data-retrieval.html)

</details>

---

<details>
<summary><strong>11. Networking Foundations (DNS, TCP, OSI Layers)</strong></summary>

---

## Why do we need prerequisites before OSI?

Before the OSI model starts wrapping and sending data, two things usually happen first:  
1. We find the server‚Äôs **IP address**.  
2. We make sure there‚Äôs a **reliable connection**.

These two steps are like finding where the restaurant is and confirming the phone line works ‚Äî only then can we start ‚Äútalking.‚Äù

---

## A) Domain Name System (DNS)

*Analogy:* You know the **restaurant‚Äôs name** (‚Äúgoogle.com‚Äù) but not its **street address**.  
DNS is the **telephone directory** that gives you the real address (the IP).

**Steps:**
1. Browser checks its local cache.  
2. If not found ‚Üí asks the **router** ‚Üí then your **ISP‚Äôs DNS**.  
3. ISP may ask **Root** ‚Üí **TLD** (like `.com`) ‚Üí **Authoritative** DNS server.  
4. The authoritative server replies with the correct **IP address** (e.g., `142.250.xx.xx`).

üëâ Without DNS, we‚Äôd have to memorize IPs instead of names ‚Äî like remembering every restaurant‚Äôs GPS coordinates.

---

## B) Transmission Control Protocol (TCP) ‚Äì 3-Way Handshake

*Analogy:* Starting a phone call:  
- You: ‚ÄúHello, can you hear me?‚Äù  
- Server: ‚ÄúYes, I can.‚Äù  
- You: ‚ÄúGreat, let‚Äôs talk.‚Äù

**Steps:**
1. **SYN (Synchronize)** ‚Üí Client: ‚ÄúI want to connect.‚Äù  
2. **SYN-ACK (Synchronize + Acknowledge)** ‚Üí Server: ‚ÄúI hear you; I‚Äôm ready.‚Äù  
3. **ACK (Acknowledge)** ‚Üí Client: ‚ÄúConfirmed, let‚Äôs begin.‚Äù

‚úÖ Now the connection is reliable.  
(When using **HTTPS**, a **TLS handshake** happens right after this to secure the communication.)

---

## C) OSI 7 Layers (Top ‚Üí Bottom)

---

### Layer 7 ‚Äî Application

This is where the **user interacts** directly.  
Example: You type `https://www.google.com` ‚Üí your browser sends an **HTTP/HTTPS request** because **you asked for it**.

Common protocols:  
- **HTTP/HTTPS** ‚Äì web traffic  
- **FTP** ‚Äì file transfers  
- **SMTP/IMAP** ‚Äì emails

üëâ **Analogy:** You‚Äôre **writing the letter** you want to send.

---

### Layer 6 ‚Äî Presentation

Handles **formatting, encryption, and compression** so the data looks correct and secure.  
Example: HTTPS encrypts your message before sending.

üëâ **Analogy:** You **seal the letter in an envelope and lock it**.

---

### Layer 5 ‚Äî Session

Creates and maintains **sessions** between two systems.  
Example: You log in to **Instagram**, and for the next few minutes you don‚Äôt need to log in again ‚Äî the session is active.  
If you log out or it expires, the session closes.

üëâ **Analogy:** You **keep the call alive** until one side hangs up.

---

### Layer 4 ‚Äî Transport

Breaks big data into **segments**, numbers them, and ensures everything arrives correctly.  
Two key protocols live here:

- **TCP** ‚Üí Reliable, ordered, connection-based (used by HTTPS).  
- **UDP** ‚Üí Faster, connectionless, no guarantee (used by video calls, games, DNS queries).

Example: Sending a **10 GB wedding video** ‚Äî it‚Äôs split into small numbered pieces that are reassembled on the other side.

üëâ **Analogy:** You **pack your gift into multiple numbered boxes** so none are lost.

---

### Layer 3 ‚Äî Network

Adds **IP addresses** and decides how to reach the destination.  
Routers pick the **best path** to get data from your computer to the target server.

Example: Going from **Delhi ‚Üí Mumbai**, there are many roads; the router picks the fastest route.

üëâ **Analogy:** You **write sender and receiver addresses** on the package.

---

### Layer 2 ‚Äî Data Link

Works inside your **local network (LAN, Wi-Fi, Ethernet)**.  
It converts **packets ‚Üí frames** and adds **MAC addresses** for local delivery.

Example: Your router knows which device to send data to ‚Äî your phone or your laptop ‚Äî using their unique MAC IDs.

üëâ **Analogy:** A **local delivery truck** takes your package to the right house on the same street.

---

### Layer 1 ‚Äî Physical

Turns everything into **bits (0s and 1s)** and sends them as signals over **wires or air**.  
Examples: Fiber optics, copper cables, Wi-Fi signals.

üëâ **Analogy:** These are the **roads themselves** ‚Äî the physical paths the trucks drive on.

---

## D) Encapsulation & Decapsulation

When you send data, it moves **down** through all layers (7 ‚Üí 1).  
When the receiver gets it, it moves **up** (1 ‚Üí 7).

```

Sender:   L7 ‚Üí L6 ‚Üí L5 ‚Üí L4 ‚Üí L3 ‚Üí L2 ‚Üí L1  (wrap the data)
Network:  --- bits travel through wires/Wi-Fi ---
Receiver: L1 ‚Üí L2 ‚Üí L3 ‚Üí L4 ‚Üí L5 ‚Üí L6 ‚Üí L7  (unwrap the data)

```

üí° **Analogy:**  
You wrap a gift in multiple boxes before shipping it.  
At the other end, the receiver opens each box layer by layer to reach the actual item.

---

‚úÖ **Key Takeaways:**
1. **DNS** finds where to send data.  
2. **TCP handshake** makes the connection reliable.  
3. **OSI layers** define how the message is wrapped, sent, and understood.  
4. Each layer adds its own ‚Äúbox‚Äù to keep communication smooth and universal.

üì∏ **Reference:** [AWS Networking Whitepaper](https://docs.aws.amazon.com/whitepapers/latest/aws-overview/networking.html)

</details>

---

<details>
<summary><strong>12. Load Balancer (with Health Checks)</strong></summary>

---

## Why do we need a Load Balancer?

One server works until traffic grows. Then it slows, crashes, or becomes a single point of failure.  
A **Load Balancer (LB)** sits in front and **spreads requests** across many servers.

**Analogy:** A traffic police officer at a busy junction, sending cars into free lanes so no lane jams.

---

## How it works (simple view)

1. Users hit the **LB** (one public endpoint).
2. LB forwards each request to **healthy** EC2 instances.
3. **Health checks** run constantly. If an instance fails, LB stops sending traffic there.

**Common algorithm:**  
- **Round Robin** = 1st request ‚Üí Server A, 2nd ‚Üí Server B, 3rd ‚Üí Server C, then back to A‚Ä¶

```

```
     Internet Users
            ‚îÇ
            ‚ñº
     +---------------+
     | Load Balancer |
     +---------------+
        ‚îÇ     ‚îÇ     ‚îÇ
        ‚ñº     ‚ñº     ‚ñº
     EC2 A  EC2 B  EC2 C
```

```

---

## Health checks (must-have)

- Path/port the LB probes, e.g., `HTTP:80 /healthz` ‚Üí expect **200 OK**  
- Thresholds: how many passes/fails before ‚Äúhealthy/unhealthy‚Äù  
- Purpose: remove bad instances automatically

---

## Types of AWS Load Balancers

| Type | OSI Layer | Best For | Highlights |
|-----|-----------|----------|------------|
| **Application (ALB)** | Layer 7 | HTTP/HTTPS web apps | Path/host routing, headers, cookies, WebSockets, TLS termination with ACM |
| **Network (NLB)** | Layer 4 | Extreme performance TCP/UDP | Very low latency, static IP/EIP per AZ, TLS pass-through/termination |
| **Gateway (GWLB)** | Layer 3 | Firewalls / inspection | Transparent appliance insertion |
| **Classic (CLB)** | 4/7 | Legacy only | Old gen‚Äîprefer ALB/NLB for new apps |

**Good defaults for web apps (ALB):**
- Redirect **HTTP ‚Üí HTTPS**
- **TLS** termination at ALB (managed certs via **ACM**)
- Health check on `/healthz`
- Consider **AWS WAF** and **access logs**

üì∏ **Reference:**  
[AWS Elastic Load Balancing](https://docs.aws.amazon.com/elasticloadbalancing/latest/userguide/what-is-load-balancing.html)

</details>

---

<details>
<summary><strong>13. Auto Scaling & Monitoring</strong></summary>

---

## Why Auto Scaling?

Traffic changes all day.  
- If you size for peak all the time ‚Üí **waste money**.  
- If you size small ‚Üí **downtime** during spikes.

**Auto Scaling** grows and shrinks capacity automatically.

**Analogy:** Open extra billing counters when the line gets long; close them when the store is empty.

---

## Core building blocks

1. **Launch Template**  
   - The ‚Äúrecipe‚Äù for new instances (AMI, type, SGs, User Data, IAM role)
2. **Auto Scaling Group (ASG)**  
   - Controls **Min / Desired / Max** instance counts
3. **Scaling Policies**  
   - **Target tracking**: keep a metric steady (e.g., CPU ~ 60%)  
   - **Step scaling**: thresholds add/remove in steps  
   - **Scheduled**: time-based (e.g., weekdays 9 AM scale up)
4. **Health checks**  
   - Replace unhealthy instances (EC2/ELB health)
5. **Lifecycle hooks** (optional)  
   - Run scripts before instance joins/leaves (warm-up, drain, save logs)

```

```
        Internet Users
              ‚îÇ
              ‚ñº
       [ Load Balancer ]
              ‚îÇ
  ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
  ‚ñº                       ‚ñº
```

[ EC2 ]                 [ EC2 ]
‚ñ≤                       ‚ñ≤
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
‚îÇ
Auto Scaling Group
Min=2  Desired=2  Max=6
‚Üë Add when metric rises (scale out)
‚Üì Remove when metric falls (scale in)

```

---

## Monitoring (keep an eye)

- **CloudWatch Metrics**: CPU, Network, ELB TargetResponseTime, RequestCountPerTarget, custom app metrics  
- **CloudWatch Alarms**: trigger scaling or alerts  
- **CloudWatch Logs**: ship system/app logs  
- **Dashboards**: single pane of health

---

## A simple, safe starting pattern

- Put instances in **multiple AZs** behind an **ALB**  
- ASG: **Min=2**, Desired starts at 2, **Max** sized for spikes  
- **Target tracking** on CPU (e.g., 50‚Äì60%) or ALB metrics (RequestCountPerTarget)  
- Health check grace period during warm-up  
- Use **Instance Refresh** for rolling updates (new AMI/LT)

üì∏ **References:**  
[Amazon EC2 Auto Scaling](https://docs.aws.amazon.com/autoscaling/ec2/userguide/what-is-amazon-ec2-auto-scaling.html)  
[Amazon CloudWatch](https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/WhatIsCloudWatch.html)

</details>