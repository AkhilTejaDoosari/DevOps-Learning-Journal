# Elastic Block Store (EBS)

## Table of Contents
1. [What Is EBS?](#1-what-is-ebs)
2. [How EBS Works with EC2](#2-how-ebs-works-with-ec2)
3. [EBS Volume Types](#3-ebs-volume-types)
4. [Snapshots & Backup Mechanism](#4-snapshots--backup-mechanism)
5. [Cross-AZ and Cross-Region Copy](#5-cross-az-and-cross-region-copy)
6. [EBS Encryption](#6-ebs-encryption)
7. [Modifying Volumes (Resize, Migrate, Tune)](#7-modifying-volumes-resize-migrate-tune)
8. [Performance Essentials (IOPS & Throughput)](#8-performance-essentials-iops--throughput)
9. [Best Practices & Cost Optimization](#9-best-practices--cost-optimization)
10. [Quick Summary](#10-quick-summary)

---

<details>
<summary><strong>1. What Is EBS?</strong></summary>

**Elastic Block Store (EBS)** is a **persistent block storage** service designed for Amazon EC2 instances.  
Each EBS volume behaves like a **virtual hard drive** â€” you can format it, mount it, detach it, and re-attach it to other EC2 instances within the same Availability Zone (AZ).

Even if you stop or restart your instance, **the data remains intact**, making EBS a reliable storage layer for OS files, applications, and databases.

ðŸ’¡ **Analogy (minimal use):**  
Think of EBS as a **detachable SSD** for your EC2 instance â€” you can unplug it, carry it to another machine in the same data center (AZ), and plug it back in without losing your data.

**Key properties:**
- **Persistent**: Data survives instance stop/start.
- **Block-level**: You manage it like a raw disk.
- **Flexible**: You can increase size, change performance, or migrate without downtime.
- **AZ-scoped**: Must be in the same Availability Zone as the instance.

ðŸ“¸ **Reference:** [Amazon EBS Volumes](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-volumes.html)
</details>

---

<details>
<summary><strong>2. How EBS Works with EC2</strong></summary>

EBS volumes attach to EC2 instances over the **availability zone network**.  
When you launch an EC2 instance, it can have:
- **Root Volume:** Stores OS and boot files.
- **Additional Data Volumes:** For app data, logs, or databases.

**High-level flow:**

```

EBS Volume  <â”€â”€attachedâ”€â”€>  EC2 Instance
â”‚
â””â”€â”€ Snapshots stored in S3 (for backup & cloning)

```

- EBS is **replicated automatically within its AZ** to prevent data loss.
- You can attach **multiple EBS volumes** to one EC2, or attach a single EBS volume to multiple EC2s (only for io1/io2 Multi-Attach use cases).

ðŸ’¡ **Use Case Examples:**
- Root volume for Linux/Windows OS.
- Application data storage for web servers.
- Database storage (MySQL, PostgreSQL).
- Persistent log storage or caching layer.
</details>

---

<details>
<summary><strong>3. EBS Volume Types</strong></summary>

| Volume Type | Medium | Description | Best For |
|--------------|---------|--------------|-----------|
| **gp3** | SSD | General-purpose SSD with configurable IOPS (up to 16,000) and throughput (up to 1,000 MB/s). | Most workloads â€“ OS, applications, boot volumes |
| **io2/io1** | SSD | Provisioned IOPS SSD with consistent latency and Multi-Attach support. | High-performance databases |
| **st1** | HDD | Throughput-optimized HDD for large sequential workloads. | Big data, logs, streaming workloads |
| **sc1** | HDD | Cold HDD with lowest cost and lowest performance. | Archival and infrequently accessed data |

ðŸ’¡ **Tip:**  
Use **gp3** by default unless you have a clear reason to optimize for either IOPS (io2/io1) or cost (st1/sc1).

ðŸ“˜ **Durability:**  
EBS volumes provide **99.999% availability** within an AZ due to internal replication.
</details>

---

<details>
<summary><strong>4. Snapshots & Backup Mechanism</strong></summary>

A **snapshot** is a **point-in-time backup** of an EBS volume stored in Amazon S3.  
Although stored in S3, snapshots are managed transparently by EBS.

```

EBS Volume â†’ Snapshot â†’ New Volume

````

- **First snapshot** = full copy  
- **Subsequent snapshots** = incremental (only changed blocks)
- Snapshots can be **used to create new volumes**, **copied across regions**, or **automated via Lifecycle Manager**.

ðŸ’¡ **Analogy:**  
Itâ€™s like taking a **photo of your diskâ€™s current state**.  
If anything breaks later, you can rebuild an exact copy using that snapshot.

ðŸ“¸ **Reference:** [EBS Snapshots](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSSnapshots.html)
</details>

---

<details>
<summary><strong>5. Cross-AZ and Cross-Region Copy</strong></summary>

You can use snapshots to **clone volumes** across Availability Zones or Regions.

### Cross-AZ (within same region)
1. Create a snapshot of the source volume (e.g., `us-east-1a`).
2. Use that snapshot to create a new volume in another AZ (e.g., `us-east-1b`).
3. Attach it to an EC2 instance there.

### Cross-Region
1. Copy the snapshot to another region.
2. Create a volume from that copy.
3. Attach to EC2 in the destination region.

ðŸ’¡ **Analogy:**  
Itâ€™s like **replicating your disk** to a different branch office â€” same setup, new location.

ðŸ“¸ **Reference:** [Copy Snapshots](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-copy-snapshot.html)
</details>

---

<details>
<summary><strong>6. EBS Encryption</strong></summary>

EBS provides **encryption at rest and in transit** using **AWS KMS** (Key Management Service).  
You can use **AWS-managed keys (aws/ebs)** or **customer-managed CMKs**.

**Key points:**
- Encrypted data stays encrypted during I/O operations.
- Snapshots of encrypted volumes are also encrypted.
- New volumes created from encrypted snapshots remain encrypted.
- Enable **EBS encryption by default** in your account for consistency.

ðŸ“˜ **Command:**
```bash
aws ec2 enable-ebs-encryption-by-default
````

ðŸ“¸ **Reference:** [EBS Encryption](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/EBSEncryption.html)

</details>

---

<details>
<summary><strong>7. Modifying Volumes (Resize, Migrate, Tune)</strong></summary>

You can dynamically **resize** or **change** EBS volume attributes without detaching it.

**Options you can modify:**

* Size (GB)
* IOPS
* Throughput (for gp3)

**After resizing:**

* Extend partition and filesystem inside the OS (`growpart`, `xfs_growfs`).

**Migration approach:**

* Create snapshot â†’ New volume (different type or region) â†’ Attach â†’ Sync data.

ðŸ“˜ **Example command:**

```bash
aws ec2 modify-volume --volume-id vol-1234567890abcdef --size 200 --iops 8000 --throughput 600
```

ðŸ“¸ **Reference:** [Modify EBS Volumes](https://docs.aws.amazon.com/AWSEC2/latest/UserGuide/ebs-modify-volume.html)

</details>

---

<details>
<summary><strong>8. Performance Essentials (IOPS & Throughput)</strong></summary>

**IOPS (Input/Output Operations Per Second)** â†’ speed for small random reads/writes.
**Throughput (MB/s)** â†’ speed for large sequential data transfers.

| Metric     | gp3 (max)  | io2 (max)             | st1/sc1              |
| ---------- | ---------- | --------------------- | -------------------- |
| IOPS       | 16,000     | 256,000 (provisioned) | Low                  |
| Throughput | 1,000 MB/s | 4,000 MB/s            | High sequential only |
| Latency    | ~5 ms      | <1 ms                 | High (HDD latency)   |

ðŸ’¡ **Tip:**
Monitor performance using **CloudWatch metrics** like `VolumeReadOps`, `VolumeWriteOps`, `VolumeThroughputPercentage`, etc.

</details>

---

<details>
<summary><strong>9. Best Practices & Cost Optimization</strong></summary>

âœ… Use **gp3** for most workloads (better performance per $).
âœ… Set **volume and snapshot tags** for cost tracking.
âœ… Enable **EBS Lifecycle Manager** to automatically delete old snapshots.
âœ… For large-scale systems, **align IOPS with EC2 bandwidth** to avoid bottlenecks.
âœ… Use **RAID 0** (striping) for high I/O and **RAID 1** (mirroring) for durability if needed.
âœ… Always **unmount before detaching** volumes to avoid data corruption.

</details>

---

<details>
<summary><strong>10. Quick Summary</strong></summary>

| Task                      | Command                                                                                                    | Description                        |
| ------------------------- | ---------------------------------------------------------------------------------------------------------- | ---------------------------------- |
| Create new gp3 volume     | `aws ec2 create-volume --size 50 --availability-zone us-east-1a --volume-type gp3`                         | Creates 50 GB volume               |
| Attach volume             | `aws ec2 attach-volume --volume-id <id> --instance-id <id> --device /dev/xvdf`                             | Mounts volume to instance          |
| Create snapshot           | `aws ec2 create-snapshot --volume-id <id> --description "backup"`                                          | Point-in-time backup               |
| Copy snapshot             | `aws ec2 copy-snapshot --source-region us-east-1 --source-snapshot-id <id> --destination-region us-west-2` | Cross-region copy                  |
| Modify volume             | `aws ec2 modify-volume --volume-id <id> --size 200`                                                        | Resize volume                      |
| List volumes              | `aws ec2 describe-volumes`                                                                                 | View all attached/detached volumes |
| Enable encryption default | `aws ec2 enable-ebs-encryption-by-default`                                                                 | Enforces KMS encryption            |

**Linux Filesystem Resize Example:**

```bash
lsblk                                # list block devices
sudo growpart /dev/xvdf 1            # extend partition
sudo xfs_growfs /                    # expand filesystem
```

**Output:**

```output
data blocks changed from 26214400 to 52428800
Filesystem successfully expanded
```

</details>