# 02 - IAM 

<details>
<summary><strong>1. AWS IAM (Identity & Access Management)</strong></summary>

## 1. What is IAM?
- **Global AWS service** (not region-specific)
- Manages **users, groups, permissions**, and security policies
- **Root Account**:
  - Created automatically when AWS account is set up
  - **Only use for**: Initial setup (billing, security)
  - **Never use daily** or share credentials



## 2. Users & Groups

<img src="images/IAM.png" alt="IAM" width="600" height="150" /> 

### A. Users
- Represents a **person or service** (e.g., `Alice`, `Bob`)
- **Best Practice**:
  - One user = One person (no sharing)
  - Assign permissions via policies

### B. Groups
- **Purpose**: Organize users (e.g., `Developers`, `Operations`)
- **Rules**:
  - Groups **only contain users** (not other groups)
  - Users **can belong to multiple groups** (e.g., `Charles` in both `Developers` and `Audit Team`)
  - Users *don't need* to be in a group (but **not recommended**)

### C. Group-User Structure
| Group        | Users            | Notes                         |
|--------------|------------------|-------------------------------|
| Developers   | Alice, Bob, Charles | Developers need EC2 access   |
| Operations   | David, Edward     | Manages deployments           |
| Audit Team   | Charles, David    | Cross-team collaboration      |
| (No Group)   | Fred              | **Avoid this** - assign groups|

## 3. Permissions & Policies
### A. IAM Policies
- **JSON documents** defining permissions
- **Attached to**: Users, Groups, or Roles

### B. Example Policy
```json
{
  "Version": "2012-10-17",
  "Statement": [
    {
      "Effect": "Allow",
      "Action": "ec2:Describe*",       // Allows viewing EC2 instances
      "Resource": "*"                 // Applies to all resources
    },
    {
      "Effect": "Allow",
      "Action": "elasticloadbalancing:Describe*",           // View load balancers
      "Resource": "*"
    },
    {
      "Effect": "Allow",
      "Action": [                                        // CloudWatch permissions
        "cloudwatch:ListMetrics",
        "cloudwatch:GetMetricStatistics",
        "cloudwatch:Describe*"
      ],
      "Resource": "*"
    }
  ]
}
```
   - `Describe*` actions = read-only access
   - `Resource: "*"` = applies to all resources

### C. Key Concepts
- **Least Privilege Principle**: Grant only necessary permissions
- **Policy Structure**:
  - `Effect`: `Allow` or `Deny`
  - `Action`: Specific API calls (e.g., `ec2:Describe*`)
  - `Resource`: Which AWS resources apply (e.g., S3 bucket, EC2 instance).

## 4. Best Practices
1. **Never use root account** for daily tasks
2. **Use groups** to manage permissions at scale
3. **Regularly audit permissions** (remove unused access)
4. **Enable MFA** for all users
5. **Use IAM Roles** for AWS services

## Key Takeaways
âœ… **Root Account**: Only for emergencies  
âœ… **Users & Groups**: Organize by job function  
âœ… **Policies**: JSON rules for granular control  
ðŸš« **Avoid**: Over-permissive policies (`"Action": "*"`)

</details>

---

<details>
<summary><strong>2. IAM Policies </strong></summary>

### User & Group Structure

<img src="images/IAM_Policies_inheritance.png" alt="IAM" width="600" height="300" /> 

### Groups and Their Members
| Group        | Members          | Policy Type       |
|--------------|------------------|-------------------|
| Developers   | Alice, Bob, Charles | Group Policy     |
| Operations   | David, Edward    | Group Policy      |
| Audit Team   | Charles, David   | Group Policy      |
| (Standalone) | Fred             | Inline Policy     |

## Key Concepts

### A. Policy Types
1. **Group Policies**:
   - Applied to all group members
   - Example: Developers policy â†’ Alice, Bob, Charles
2. **Inline Policies**:
   - Attached directly to individual users
   - Example: Fred's custom policy
3. **Multiple Inheritance**:
   - Users get combined policies from all groups they belong to
   - Example: 
     - Charles: Developers + Audit Team policies
     - David: Operations + Audit Team policies

---

### B. IAM Policy Structure (Core Fields)

```json
{
  "Version": "2012-10-17",       // Required: Always use this version
  "Id": "S3-Account-Permissions", // Optional: Human-readable ID
  "Statement": [                 // Required: Permission blocks
    {
      "Sid": "1",                // Optional: Statement ID
      "Effect": "Allow",         // Required: Allow/Deny
      "Principal": {             // Required*: Who it applies to
        "AWS": ["arn:aws:iam::123456789012:root"] 
      },
      "Action": [                // Required: API actions
        "s3:GetObject",          // â—½ Read objects
        "s3:PutObject"           // â—½ Write objects
      ],
      "Resource": ["arn:aws:s3:::mybucket/*"] // Required: Target resources
    }
  ]
}
```

### Field Reference Table (For Quick Lookup)
| Field        | Req? | Example Value                      | Notes                          |
|--------------|------|------------------------------------|--------------------------------|
| **Version**  | Yes  | `"2012-10-17"`                    | Policy language version        |
| **Id**       | No   | `"S3-Account-Permissions"`        | Friendly name for the policy   |
| **Sid**      | No   | `"1"`                             | Statement identifier           |
| **Effect**   | Yes  | `"Allow"` or `"Deny"`             | Permission grant/block         |
| **Principal**| Yes* | `"AWS": ["arn:aws:iam::..."]`     | Applies to root/user/role      |
| **Action**   | Yes  | `["s3:GetObject"]`                | Specific API calls             |
| **Resource** | Yes  | `"arn:aws:s3:::mybucket/*"`       | Target AWS resources           |

## Key Takeaways (From Your Notes)
1. **Group Policies** â†’ Apply to all members (e.g., Developers group â†’ Alice/Bob/Charles)
2. **Inline Policies** â†’ User-specific (e.g., Fred's custom policy)
3. **Multiple Inheritance** â†’ Users get combined policies from all groups (Charles: Developers + Audit Team)
4. **Exam Focus**: Master `Effect`, `Action`, and `Resource` fields

</details>